<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="commonSql">
	<insert id="insertAtth" parameterType="hashmap">
		INSERT INTO FILE_ATCH (
			   PERSON_ID
			 , FILE_ID
			 , OGN_FILE_NM
			 , FILE
		) VALUES (
			   #{PERSON_ID}
			 , REPLACE(UUID(), '-', '')
			 , #{OGN_FILE_NM}
			 , #{FILE}
		)
	</insert>
	
	<select id="selectFiles" resultType="java.util.HashMap">
		SELECT AA.FILE_ID
			, AA.PERSON_ID
			, AA.OGN_FILE_NM
			, AA.FILE
		FROM (
			SELECT FILE_ID
				, PERSON_ID
				, OGN_FILE_NM
				, FILE
			FROM FILE_ATCH 
			) AA
		WHERE AA.PERSON_ID = #{PERSON_ID}
	</select>
	
	<select id="selectFileForDownload" resultType="java.util.HashMap">
		SELECT AA.FILE_ID
			, AA.PERSON_ID
			, AA.OGN_FILE_NM
			, AA.FILE
		FROM (
			SELECT FILE_ID
				, PERSON_ID
				, OGN_FILE_NM
				, FILE
			FROM FILE_ATCH 
			) AA
		WHERE AA.FILE_ID = #{FILE_ID}
	</select>
	
</mapper>